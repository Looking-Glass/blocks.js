(function(n,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("@auth0/auth0-spa-js"),require("graphql-request")):typeof define=="function"&&define.amd?define(["exports","@auth0/auth0-spa-js","graphql-request"],a):(n=typeof globalThis<"u"?globalThis:n||self,a((n["@lookingglass/blocks"]=n["@lookingglass/blocks"]||{},n["@lookingglass/blocks"].js={}),n.auth0SpaJs,n["graphql-request"]))})(this,function(n,a,l){"use strict";var T=Object.defineProperty;var V=(n,a,l)=>a in n?T(n,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[a]=l;var s=(n,a,l)=>(V(n,typeof a!="symbol"?a+"":a,l),l);const h=(e=>e&&typeof e=="object"&&"default"in e?e:{default:e})(l),o="blocksToken";let d,c;const k=()=>document.querySelector("[data-login]"),u=()=>document.querySelector("[data-logout]"),r=()=>document.querySelectorAll("[data-logged-in]"),v=()=>document.querySelectorAll("[data-logged-out]");function y(){var e,i;(e=k())==null||e.addEventListener("click",async()=>{console.log("Logging in"),await(d==null?void 0:d.loginWithRedirect({authorizationParams:{redirect_uri:c}}))}),(i=u())==null||i.addEventListener("click",async()=>{console.log("Logging out"),sessionStorage.removeItem(o),N()})}async function b(){const e=window.location.search;if(e.includes("code=")&&e.includes("state=")&&d){try{await d.handleRedirectCallback()}catch(t){console.error(t)}if(await d.isAuthenticated()){const t=await d.getTokenSilently();sessionStorage.setItem(o,t),window.history.replaceState({},document.title,window.location.pathname)}}}async function N(){m.isAuthenticated()?(k().style.display="none",u().style.display="",r().forEach(e=>{e.style.display=""}),v().forEach(e=>{e.style.display="none"})):(k().style.display="",u().style.display="none",r().forEach(e=>{e.style.display="none"}),v().forEach(e=>{e.style.display=""}))}class m{static async init(i){y(),c=i.redirectUri,d=new a.Auth0Client({domain:i.domain||"blocks.us.auth0.com",clientId:i.clientId,authorizationParams:{audience:"https://blocks.glass"}}),await b(),await N()}static isAuthenticated(){return m.getJWT()!=""}static getJWT(){return sessionStorage.getItem(o)||""}}var S;(function(e){e.Quilt="QUILT",e.Rgbd="RGBD"})(S||(S={}));var F;(function(e){e.OnlyMe="ONLY_ME",e.Password="PASSWORD",e.Public="PUBLIC",e.Unlisted="UNLISTED"})(F||(F={}));var g;(function(e){e.All="ALL",e.OnlyMe="ONLY_ME",e.Password="PASSWORD",e.Public="PUBLIC",e.Unlisted="UNLISTED"})(g||(g={}));var p;(function(e){e.OnlyMe="ONLY_ME",e.Public="PUBLIC",e.Unlisted="UNLISTED"})(p||(p={}));var f;(function(e){e.Admin="ADMIN",e.User="USER"})(f||(f={}));const q={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FindHologram"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hologramFindById"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"aspectRatio"}},{kind:"Field",name:{kind:"Name",value:"quiltCols"}},{kind:"Field",name:{kind:"Name",value:"quiltRows"}},{kind:"Field",name:{kind:"Name",value:"quiltTileCount"}},{kind:"Field",name:{kind:"Name",value:"sourceImages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fileSize"}}]}}]}}]}}]},D={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FindPlaylist"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"lookup"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"50"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"playlist"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"lookup"},value:{kind:"Variable",name:{kind:"Name",value:"lookup"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"permalink"}},{kind:"Field",name:{kind:"Name",value:"privacy"}},{kind:"Field",name:{kind:"Name",value:"updatedAt"}},{kind:"Field",name:{kind:"Name",value:"items"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"pageInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasNextPage"}},{kind:"Field",name:{kind:"Name",value:"hasPreviousPage"}},{kind:"Field",name:{kind:"Name",value:"startCursor"}},{kind:"Field",name:{kind:"Name",value:"endCursor"}}]}},{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hologramId"}},{kind:"Field",name:{kind:"Name",value:"position"}},{kind:"Field",name:{kind:"Name",value:"hologram"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"aspectRatio"}},{kind:"Field",name:{kind:"Name",value:"quiltCols"}},{kind:"Field",name:{kind:"Name",value:"quiltRows"}},{kind:"Field",name:{kind:"Name",value:"quiltTileCount"}},{kind:"Field",name:{kind:"Name",value:"sourceImages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fileSize"}}]}}]}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"thumbnail"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}}]},w={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"username"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"createdAt"}}]}}]}}]},I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"MyHolograms"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}},defaultValue:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"username"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"holograms"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"nodes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"aspectRatio"}},{kind:"Field",name:{kind:"Name",value:"quiltCols"}},{kind:"Field",name:{kind:"Name",value:"quiltRows"}},{kind:"Field",name:{kind:"Name",value:"quiltTileCount"}},{kind:"Field",name:{kind:"Name",value:"sourceImages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"fileSize"}}]}}]}}]}}]}}]}}]},A="https://blocks.glass/api/graphql";class L{constructor(i){s(this,"token");s(this,"auth");this.token=i}async me(){return await this.api({document:w})}async hologram(i){return await this.api({document:q,variables:{id:i.toString()}})}async playlist(i,t=100){return await this.api({document:D,variables:{id:i,first:t}})}async myHolograms(i=20){return await this.api({document:I,variables:{first:i}})}async api(i){const t={document:i.document,variables:i==null?void 0:i.variables,url:A,requestHeaders:{Authorization:`Bearer ${this.token}`}};return await h.default(t)}}n.BlocksClient=L,n.BlocksSpaAuth=m,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
